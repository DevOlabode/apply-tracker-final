<% layout('layout/boilerplate.ejs') %>
<div class="text-light">
  <!-- Header Section -->
  <div class="text-center mb-5">
    <h1 class="text-gradient fw-bold">
      <i class="fas fa-edit me-3"></i>
      Edit Application
    </h1>
    <p class="text-secondary">Update your job application details</p>
  </div>

  <!-- Form Section -->
  <div class="container">
    <form action="/application/<%= findApplication._id %>?_method=PUT" method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
      <div class="row g-4">
        <div class="col-md-6">
          <div class="glass-card p-4">
            <h4 class="text-gradient mb-4">Company Details</h4>
            <div class="mb-3">
              <label for="company" class="form-label text-light">Company</label>
              <input type="text" class="form-control" id="company" name="company" value="<%= findApplication.company %>" required>
            </div>
            <div class="mb-3">
              <label for="position" class="form-label text-light">Position</label>
              <input type="text" class="form-control" id="position" name="position" value="<%= findApplication.position %>" required>
            </div>
            <div class="mb-3">
              <label for="status" class="form-label text-light">Status</label>
              <select class="form-select bg-dark" id="status" name="status" required>
                <option value="applied" <%= findApplication.status === 'applied' ? 'selected' : '' %>>Applied</option>
                <option value="interviewing" <%= findApplication.status === 'interviewing' ? 'selected' : '' %>>Interviewing</option>
                <option value="offer" <%= findApplication.status === 'offer' ? 'selected' : '' %>>Offer</option>
                <option value="hired" <%= findApplication.status === 'hired' ? 'selected' : '' %>>Hired</option>
                <option value="rejected" <%= findApplication.status === 'rejected' ? 'selected' : '' %>>Rejected</option>
              </select>
            </div>
          </div>
        </div>

        <div class="col-md-6">
          <div class="glass-card p-4">
            <h4 class="text-gradient mb-4">Application Details</h4>
            <div class="mb-3">
              <label for="appliedDate" class="form-label text-light">Applied Date</label>
              <input type="date" class="form-control" id="appliedDate" name="appliedDate" value="<%= findApplication.appliedDate %>" required>
            </div>
            <div class="mb-3">
              <label for="interviewDate" class="form-label text-light">Interview Date</label>
              <input type="date" class="form-control" id="interviewDate" name="interviewDate" value="<%= findApplication.interviewDate %>">
            </div>
            <div class="mb-3">
              <label for="notes" class="form-label text-light">Notes</label>
              <textarea class="form-control" id="notes" name="notes" rows="4"><%= findApplication.notes %></textarea>
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="glass-card p-4">
            <h4 class="text-gradient mb-4">Additional Details</h4>
            <div class="mb-3">
              <label for="url" class="form-label text-light">Job URL</label>
              <input type="url" class="form-control" id="url" name="url" value="<%= findApplication.url %>">
            </div>


            <div class="mb-3">

              <label for="resumeFile" class="form-label text-light">Resume</label>
              
              <% if(findApplication.resumeFile && findApplication.resumeFile.originalName){ %>
              <p class="text-light">
                  Current file: <span class="opacity-50"><%= findApplication.resumeFile.originalName %></span>
              </p>
            <% } %>
              <input type="file" class="form-control" id="resumeFile" name="resumeFile" value="">
            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="text-center">
            <button type="submit" class="btn btn-primary btn-lg px-5">
              <i class="fas fa-save me-2"></i>Update Application
            </button>
            <a href="/application/<%= findApplication._id %>" class="btn btn-outline-light ms-3">
              <i class="fas fa-arrow-left me-2"></i>Cancel
            </a>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
